<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Multivariate Data Analysis | Fundamentals of Data Analysis in R</title>
  <meta name="description" content="<p>This is a collection of tutorials that illustrate how to analyse data in R.
The topics touched on this collection span univariate data analysis, multivariate data analysis, and fundamentals of machine learning.</p>" />
  <meta name="generator" content="bookdown 0.28.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Multivariate Data Analysis | Fundamentals of Data Analysis in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a collection of tutorials that illustrate how to analyse data in R.
The topics touched on this collection span univariate data analysis, multivariate data analysis, and fundamentals of machine learning.</p>" />
  <meta name="github-repo" content="eddiecg/Data-analysis-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Multivariate Data Analysis | Fundamentals of Data Analysis in R" />
  
  <meta name="twitter:description" content="<p>This is a collection of tutorials that illustrate how to analyse data in R.
The topics touched on this collection span univariate data analysis, multivariate data analysis, and fundamentals of machine learning.</p>" />
  

<meta name="author" content="Eddie Cano-Gamez" />


<meta name="date" content="2022-08-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bivariate-data-analysis.html"/>
<link rel="next" href="web-scraping-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamentals of Data Analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to Programming in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#calculations-in-r"><i class="fa fa-check"></i><b>1.1</b> Calculations in R</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#variable-assignation-in-r"><i class="fa fa-check"></i><b>1.2</b> Variable assignation in R</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#data-types-in-r"><i class="fa fa-check"></i><b>1.3</b> Data types in R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#numeric-variables"><i class="fa fa-check"></i><b>1.3.1</b> Numeric variables</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#character-variables"><i class="fa fa-check"></i><b>1.3.2</b> Character variables</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#logical-variables"><i class="fa fa-check"></i><b>1.3.3</b> Logical variables</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#categorical-variables-factors"><i class="fa fa-check"></i><b>1.3.4</b> Categorical variables (factors)</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#working-with-multiple-numbers-in-r"><i class="fa fa-check"></i><b>1.4</b> Working with multiple numbers in R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#vectors"><i class="fa fa-check"></i><b>1.4.1</b> Vectors</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#lists"><i class="fa fa-check"></i><b>1.4.2</b> Lists</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#matrices"><i class="fa fa-check"></i><b>1.4.3</b> Matrices</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#data-frames"><i class="fa fa-check"></i><b>1.4.4</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#manipulating-data-in-r"><i class="fa fa-check"></i><b>1.5</b> Manipulating data in R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#working-with-lists-of-data-frames"><i class="fa fa-check"></i><b>1.5.1</b> Working with lists of data frames</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#extending-rs-funcitonality-with-libraries"><i class="fa fa-check"></i><b>1.6</b> Extending R’s funcitonality with libraries</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#writing-data-from-r"><i class="fa fa-check"></i><b>1.7</b> Writing data from R</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#writing-human-readable-files"><i class="fa fa-check"></i><b>1.7.1</b> Writing human readable files</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#writing-binary-files"><i class="fa fa-check"></i><b>1.7.2</b> Writing binary files</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>1.8</b> Reading data into R</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#project-work"><i class="fa fa-check"></i><b>1.9</b> Project work</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html"><i class="fa fa-check"></i><b>2</b> Univariate Data Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#visualising-univariate-data"><i class="fa fa-check"></i><b>2.1</b> Visualising univariate data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#dot-plot-strip-chart"><i class="fa fa-check"></i><b>2.1.1</b> Dot plot / Strip chart</a></li>
<li class="chapter" data-level="2.1.2" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#histograms"><i class="fa fa-check"></i><b>2.1.2</b> Histograms</a></li>
<li class="chapter" data-level="2.1.3" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#density-plot"><i class="fa fa-check"></i><b>2.1.3</b> Density plot</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#summarising-univariate-data"><i class="fa fa-check"></i><b>2.2</b> Summarising univariate data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#mean"><i class="fa fa-check"></i><b>2.2.1</b> Mean</a></li>
<li class="chapter" data-level="2.2.2" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#median"><i class="fa fa-check"></i><b>2.2.2</b> Median</a></li>
<li class="chapter" data-level="2.2.3" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#quantiles"><i class="fa fa-check"></i><b>2.2.3</b> Quantiles</a></li>
<li class="chapter" data-level="2.2.4" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#standard-deviation"><i class="fa fa-check"></i><b>2.2.4</b> Standard deviation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#comparing-data-to-probability-distributions"><i class="fa fa-check"></i><b>2.3</b> Comparing data to probability distributions</a></li>
<li class="chapter" data-level="2.4" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#box-plots"><i class="fa fa-check"></i><b>2.4</b> Box plots</a></li>
<li class="chapter" data-level="2.5" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#data-as-a-random-sample"><i class="fa fa-check"></i><b>2.5</b> Data as a random sample</a></li>
<li class="chapter" data-level="2.6" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#exercises"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
<li class="chapter" data-level="2.7" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#references"><i class="fa fa-check"></i><b>2.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Bivariate Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#visualising-two-variables"><i class="fa fa-check"></i><b>3.1</b> Visualising two variables</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#scatter-plot"><i class="fa fa-check"></i><b>3.1.1</b> Scatter plot</a></li>
<li class="chapter" data-level="3.1.2" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#bivariate-box-plots"><i class="fa fa-check"></i><b>3.1.2</b> Bivariate box plots</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#applying-transformations-to-a-variable"><i class="fa fa-check"></i><b>3.2</b> Applying transformations to a variable</a></li>
<li class="chapter" data-level="3.3" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#using-ggplot2-to-create-personalised-plots"><i class="fa fa-check"></i><b>3.3</b> Using ggplot2 to create personalised plots</a></li>
<li class="chapter" data-level="3.4" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
<li class="chapter" data-level="3.5" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#covariance"><i class="fa fa-check"></i><b>3.5</b> Covariance</a></li>
<li class="chapter" data-level="3.6" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#correlation"><i class="fa fa-check"></i><b>3.6</b> Correlation</a></li>
<li class="chapter" data-level="3.7" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#predictions-and-linear-models"><i class="fa fa-check"></i><b>3.7</b> Predictions and linear models</a></li>
<li class="chapter" data-level="3.8" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#correlation-does-not-equal-causation"><i class="fa fa-check"></i><b>3.8</b> Correlation does not equal causation</a></li>
<li class="chapter" data-level="3.9" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#exercises-2"><i class="fa fa-check"></i><b>3.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Multivariate Data Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#exploring-one-variable-at-a-time"><i class="fa fa-check"></i><b>4.1</b> Exploring one variable at a time</a></li>
<li class="chapter" data-level="4.2" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#analysing-all-variables-jointly"><i class="fa fa-check"></i><b>4.2</b> Analysing all variables jointly</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#scatter-plot-matrices"><i class="fa fa-check"></i><b>4.2.1</b> Scatter plot matrices</a></li>
<li class="chapter" data-level="4.2.2" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#correlation-plots"><i class="fa fa-check"></i><b>4.2.2</b> Correlation plots</a></li>
<li class="chapter" data-level="4.2.3" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#the-distance-matrix"><i class="fa fa-check"></i><b>4.2.3</b> The distance matrix</a></li>
<li class="chapter" data-level="4.2.4" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#clustering-and-dendrograms"><i class="fa fa-check"></i><b>4.2.4</b> Clustering and dendrograms</a></li>
<li class="chapter" data-level="4.2.5" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#heatmaps"><i class="fa fa-check"></i><b>4.2.5</b> Heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#exercises-3"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
<li class="chapter" data-level="4.4" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#reducing-the-number-of-dimensions"><i class="fa fa-check"></i><b>4.4</b> Reducing the number of dimensions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#combining-dimensionality-reduction-with-clustering"><i class="fa fa-check"></i><b>4.4.1</b> Combining dimensionality reduction with clustering</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#exercises-4"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
<li class="chapter" data-level="4.6" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#references-1"><i class="fa fa-check"></i><b>4.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html"><i class="fa fa-check"></i><b>5</b> Web scraping in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#example-scraping-the-imdb-website"><i class="fa fa-check"></i><b>5.1</b> Example: Scraping the IMDB website</a></li>
<li class="chapter" data-level="5.2" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#extracting-variables-using-css-selectors"><i class="fa fa-check"></i><b>5.2</b> Extracting variables using CSS selectors</a></li>
<li class="chapter" data-level="5.3" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#scraping-multiple-fields-from-a-website"><i class="fa fa-check"></i><b>5.3</b> Scraping multiple fields from a website</a></li>
<li class="chapter" data-level="5.4" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#performing-exploratory-data-analysis-eda-on-scraped-data"><i class="fa fa-check"></i><b>5.4</b> Performing exploratory data analysis (EDA) on scraped data</a></li>
<li class="chapter" data-level="5.5" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#exercises-5"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
<li class="chapter" data-level="5.6" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#references-2"><i class="fa fa-check"></i><b>5.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><i class="fa fa-check"></i><b>6</b> Machine Learning Fundamentals: Spam Detection Using a Naive Bayes Classifier</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#visualising-data"><i class="fa fa-check"></i><b>6.1</b> Visualising data</a></li>
<li class="chapter" data-level="6.2" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#pre-processing-data"><i class="fa fa-check"></i><b>6.2</b> Pre-processing data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#converting-data-to-corpus"><i class="fa fa-check"></i><b>6.2.1</b> Converting data to corpus</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#cleaning-data"><i class="fa fa-check"></i><b>6.2.2</b> Cleaning data</a></li>
<li class="chapter" data-level="6.2.3" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#visualising-clean-data"><i class="fa fa-check"></i><b>6.2.3</b> Visualising clean data</a></li>
<li class="chapter" data-level="6.2.4" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#tokenising"><i class="fa fa-check"></i><b>6.2.4</b> Tokenising</a></li>
<li class="chapter" data-level="6.2.5" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#dividing-data-into-training-and-testing-set"><i class="fa fa-check"></i><b>6.2.5</b> Dividing data into training and testing set</a></li>
<li class="chapter" data-level="6.2.6" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#correcting-data-sparsity"><i class="fa fa-check"></i><b>6.2.6</b> Correcting data sparsity</a></li>
<li class="chapter" data-level="6.2.7" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#converting-data-to-word-appearance-table"><i class="fa fa-check"></i><b>6.2.7</b> Converting data to word appearance table</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#predicting-spam-and-non-spam"><i class="fa fa-check"></i><b>6.3</b> Predicting spam and non-spam</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#training-classifier"><i class="fa fa-check"></i><b>6.3.1</b> Training classifier</a></li>
<li class="chapter" data-level="6.3.2" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#testing-classifier"><i class="fa fa-check"></i><b>6.3.2</b> Testing classifier</a></li>
<li class="chapter" data-level="6.3.3" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#evaluating-performance"><i class="fa fa-check"></i><b>6.3.3</b> Evaluating performance</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#discussion"><i class="fa fa-check"></i><b>6.4</b> Discussion</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#references-3"><i class="fa fa-check"></i><b>6.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Fundamentals: Predicting Variables Using Neural Networks</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#normalising-data"><i class="fa fa-check"></i><b>7.1</b> Normalising data</a></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#visualising-data-1"><i class="fa fa-check"></i><b>7.2</b> Visualising data</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#creating-neural-network"><i class="fa fa-check"></i><b>7.3</b> Creating neural network</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#spliting-data-into-training-and-testing-sets"><i class="fa fa-check"></i><b>7.3.1</b> Spliting data into training and testing sets</a></li>
<li class="chapter" data-level="7.3.2" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#training-neural-network"><i class="fa fa-check"></i><b>7.3.2</b> Training neural network</a></li>
<li class="chapter" data-level="7.3.3" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#testing-neural-network"><i class="fa fa-check"></i><b>7.3.3</b> Testing neural network</a></li>
<li class="chapter" data-level="7.3.4" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#evaluating-performance-1"><i class="fa fa-check"></i><b>7.3.4</b> Evaluating performance</a></li>
<li class="chapter" data-level="7.3.5" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#improving-performance-by-adding-hidden-nodes"><i class="fa fa-check"></i><b>7.3.5</b> Improving performance by adding hidden nodes</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#conclusions"><i class="fa fa-check"></i><b>7.4</b> Conclusions</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#references-4"><i class="fa fa-check"></i><b>7.5</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fundamentals of Data Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-data-analysis" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Multivariate Data Analysis<a href="multivariate-data-analysis.html#multivariate-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>On previous sessions, we learnt how to analyse data containing one or two variables. We also learnt how to obtain data from public websites via web scraping. Now we are ready to take a step further and dive into data containing multiple variables. We call this type of data “multivariate”.</p>
<p>Multivariate data can have anything from 3 or 4 to tens, hundreds or even thousands of variables. Each of these variables can be seen as a dimension, so multivarite data is also multidimensional. The majority of data that surrounds us every day is multivariate. Some examples are the following:</p>
<ol style="list-style-type: decimal">
<li><p>Movement sensors in smartphones. These sensors are able to detect variables such as position, speed, acceleartion and angular movement at different points in time. Each of these measurements is a variable. Sensor data is particularly imporant in applications of internet of things (IoT).</p></li>
<li><p>Transaction data. Banks monitor several aspects of a transaction in real time. These aspects range from location to time of the day, to amount of money moved, reference of transaction, recipient’s account and others. Banks inspect these data in real time to detect outlier transactions, which can be frauds.</p></li>
<li><p>Genetic data. In several fields of genetics such as transcriptomics (the study of gene expression) it is common to measure the levels of tens of thousands of genes. Each gene will be recorded as a variable/dimension of our data set.</p></li>
</ol>
<p>Before starting this tutorial make sure to listen to the theoretical session. This session will help you picture better what multivariate data is and how it behaves, despite not being able to see it with your eyes (since our eyes can only perceive three dimensions).</p>
<p>For completing this tutorial we will need to install three more libraries specifically designed for multivariate data analysis. You can do that by running the following code.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="multivariate-data-analysis.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;gplots&quot;</span>)</span>
<span id="cb316-2"><a href="multivariate-data-analysis.html#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;corrplot&quot;</span>)</span>
<span id="cb316-3"><a href="multivariate-data-analysis.html#cb316-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pheatmap&quot;</span>)</span></code></pre></div>
<p>Let’s now load the libraries along with some of the libraries for data analysis we studied before.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="multivariate-data-analysis.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HSAUR2)</span>
<span id="cb317-2"><a href="multivariate-data-analysis.html#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb317-3"><a href="multivariate-data-analysis.html#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rafalib)</span>
<span id="cb317-4"><a href="multivariate-data-analysis.html#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb317-5"><a href="multivariate-data-analysis.html#cb317-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span></code></pre></div>
<p>The data set “pottery” is part of the HSAUR2 package. It contains data from a 1980 study on specimens of very old Romano-British pottery found in archaeological sites in three different regions of Britain: Wales, Gloucester and New Forest. These pieces of pottery were analysed by atomic absorption spectrophotometry to determine their chemical composition. Chemists measured the levels of 9 different compounds in each piece of pottery (to be precise, 9 different types of oxide. Remember that, when creating pottery, clay is brought in contact with fire, and combustion is a type of oxidative reaction). They also added some information on the type of kiln (kind of oven) used to produced them.</p>
<p>Let’s have a first look at the data:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="multivariate-data-analysis.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pottery)</span></code></pre></div>
<pre><code>##   Al2O3 Fe2O3  MgO  CaO Na2O  K2O TiO2   MnO   BaO kiln
## 1  18.8  9.52 2.00 0.79 0.40 3.20 1.01 0.077 0.015    1
## 2  16.9  7.33 1.65 0.84 0.40 3.05 0.99 0.067 0.018    1
## 3  18.2  7.64 1.82 0.77 0.40 3.07 0.98 0.087 0.014    1
## 4  16.9  7.29 1.56 0.76 0.40 3.05 1.00 0.063 0.019    1
## 5  17.8  7.24 1.83 0.92 0.43 3.12 0.93 0.061 0.019    1
## 6  18.8  7.45 2.06 0.87 0.25 3.26 0.98 0.072 0.017    1</code></pre>
<p>Since the type of kiln is a category and not, like the rest of the variables, a number, we will not consider it for now. Let’s keep the other 9 columns of this table and store them in a variable called “pots”.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="multivariate-data-analysis.html#cb320-1" aria-hidden="true" tabindex="-1"></a>pots <span class="ot">&lt;-</span> pottery[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]</span></code></pre></div>
<p>The “pots” data has 9 dimensions (9 variables): each dimension corresponding to the levels of a chemical compound.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="multivariate-data-analysis.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pots)</span></code></pre></div>
<pre><code>##   Al2O3 Fe2O3  MgO  CaO Na2O  K2O TiO2   MnO   BaO
## 1  18.8  9.52 2.00 0.79 0.40 3.20 1.01 0.077 0.015
## 2  16.9  7.33 1.65 0.84 0.40 3.05 0.99 0.067 0.018
## 3  18.2  7.64 1.82 0.77 0.40 3.07 0.98 0.087 0.014
## 4  16.9  7.29 1.56 0.76 0.40 3.05 1.00 0.063 0.019
## 5  17.8  7.24 1.83 0.92 0.43 3.12 0.93 0.061 0.019
## 6  18.8  7.45 2.06 0.87 0.25 3.26 0.98 0.072 0.017</code></pre>
<p>Furthermore, we have measurements for 45 pieces o pottery in this data set:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="multivariate-data-analysis.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pots)</span></code></pre></div>
<pre><code>## [1] 45  9</code></pre>
<p>We do not know which pieces come from Wales, Goucester or New Forest. Is there some way to find this out?</p>
<div id="exploring-one-variable-at-a-time" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Exploring one variable at a time<a href="multivariate-data-analysis.html#exploring-one-variable-at-a-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Having 9 dimensions might be overwhelming, but each of these dimensions can be studied individually using all the methods we’ve learnt before. For example, let’s create density plots for each of the 9 variables:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="multivariate-data-analysis.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb325-2"><a href="multivariate-data-analysis.html#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb325-3"><a href="multivariate-data-analysis.html#cb325-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">density</span>(pots[,i]), <span class="at">main=</span><span class="fu">colnames</span>(pots)[i])</span>
<span id="cb325-4"><a href="multivariate-data-analysis.html#cb325-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
<p>You can see that some chemical compounds (such as barium oxide, BaO) have the characteristic “normal” (bell-shaped) distribution. Others such as calcium oxide (CaO) or Potassium oxide (K2O), however, have very unusual distributions with several modes (“bumps”).</p>
<p>Let’s now take the first two compunds: Al2O3 and Fe2O3. Are their levels related? Do they covary? Let’s create a scatter plot to answer this question.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="multivariate-data-analysis.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pots<span class="sc">$</span>Al2O3, pots<span class="sc">$</span>Fe2O3, <span class="at">xlab=</span><span class="st">&quot;Al2O3&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Fe2O3&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
<p>We see that for some pieces of pottery their is a possitive correlation, but for some other subgroup of pots the relation is negative. Could these come from two different locations? It is possible, but it is very difficult to conclude anything based on only 2 compounds.</p>
<p>Let’s try to add another dimension to the previous plot. We will use the color of the points to represent the levels of our third oxide, MgO. We do this using ggplot().</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="multivariate-data-analysis.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pots, <span class="fu">aes</span>(<span class="at">x=</span>Al2O3, <span class="at">y=</span>Fe2O3)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>MgO), <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
<p>You can see that in general pottery with high levels of Fe2O3 also has high levels of MgO. But, again, it is difficult to conclude anything with only 3 compounds.</p>
</div>
<div id="analysing-all-variables-jointly" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Analysing all variables jointly<a href="multivariate-data-analysis.html#analysing-all-variables-jointly" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="scatter-plot-matrices" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Scatter plot matrices<a href="multivariate-data-analysis.html#scatter-plot-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We cannot represent more than 3 dimensions in a plot, and even three is sometimes too confusing. However, there are some tricks that allow us to look at multiple variables in an easier way.</p>
<p>For example, we can create scatter plots for all possible combinations of variables (in this case, all the combinations of our 9 variables). This might seem laborious. After all, we do have to create 81 different plots! However, R makes it very easy for us. We only need to use the function “pairs()”. R will automatically create plots for all possiblepairs of variables in our data set and arrange them as a matrix. We call this a scatter plot matrix.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="multivariate-data-analysis.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(pots, <span class="at">pch=</span><span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
<p>Note how the plots toward the middle (the diagonal) do not have any data on them: just the labels. This is because those plots would add no information at all: they would plot the relationship of a variable with itself, which is always a straight line. Thus, R omits them.</p>
<p>We begin to see some patterns. For example, if you look at the Fe2O3 column you’ll realise that there are usually two groups of pottery: one with high Fe2O3 and one with low Fe2O3. However, it is difficult to find any meaningful patterns by eye when so much data is being displayed.</p>
<p>To enhance this visulisation a little, let’s perform linear regressions for all of these combinations of variables. To do this, we use the pairs() function to create all the possible plots and we add a line (abline) with the “best fit” line (lm) for each combination of variables. In this way, R performs and plots 72 linear regressions in just one a few lines of code.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="multivariate-data-analysis.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(pots,</span>
<span id="cb329-2"><a href="multivariate-data-analysis.html#cb329-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb329-3"><a href="multivariate-data-analysis.html#cb329-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">points</span>(x,y,...)</span>
<span id="cb329-4"><a href="multivariate-data-analysis.html#cb329-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x), <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb329-5"><a href="multivariate-data-analysis.html#cb329-5" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">pch=</span><span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
<p>Some variables follow the line relatively well, for example MgO and K2O, but some others do not.</p>
</div>
<div id="correlation-plots" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Correlation plots<a href="multivariate-data-analysis.html#correlation-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Just like we can plot all possible pairs of variables, we can also calculate the correlation of all possible pairs of variables in our 9-dimensional data. For example, let’s focus on the first three variables.</p>
<p>The correlation of Al2O3 and Fe2O3 levels is:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="multivariate-data-analysis.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(pots<span class="sc">$</span>Al2O3, pots<span class="sc">$</span>Fe2O3)</span></code></pre></div>
<pre><code>## [1] -0.1396064</code></pre>
<p>And the correlation between Al2O3 and MgO is:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="multivariate-data-analysis.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(pots<span class="sc">$</span>Al2O3, pots<span class="sc">$</span>MgO)</span></code></pre></div>
<pre><code>## [1] -0.7324515</code></pre>
<p>Finally, the correlation between Fe2O3 and MgO levels is:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="multivariate-data-analysis.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(pots<span class="sc">$</span>Fe2O3, pots<span class="sc">$</span>MgO)</span></code></pre></div>
<pre><code>## [1] 0.3932271</code></pre>
<p>We can go on for all 81 combinations. The easiest way to do this in R is simply applying the cor() function to our data. R immediately understands that what you want is to calculate not only one correlation, but all of them. These are stored in a matrix which is often called the “correlation matrix”.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="multivariate-data-analysis.html#cb336-1" aria-hidden="true" tabindex="-1"></a>corrmat <span class="ot">&lt;-</span> <span class="fu">cor</span>(pots)</span></code></pre></div>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="multivariate-data-analysis.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(corrmat)</span></code></pre></div>
<pre><code>##             Al2O3      Fe2O3        MgO         CaO       Na2O         K2O        TiO2        MnO         BaO
## Al2O3  1.00000000 -0.1396064 -0.7324515  0.23170316 0.01631415 -0.61126911  0.70311435 -0.5669065  0.31438288
## Fe2O3 -0.13960637  1.0000000  0.3932271  0.66265034 0.67373208  0.61576101 -0.14583752  0.6700777  0.21126543
## MgO   -0.73245149  0.3932271  1.0000000 -0.18583362 0.14955077  0.87409305 -0.68681267  0.7836910 -0.06647407
## CaO    0.23170316  0.6626503 -0.1858336  1.00000000 0.51609482  0.05627038  0.16486290  0.1414132  0.24928394
## Na2O   0.01631415  0.6737321  0.1495508  0.51609482 1.00000000  0.32363840  0.04242872  0.5336162  0.36574697
## K2O   -0.61126911  0.6157610  0.8740931  0.05627038 0.32363840  1.00000000 -0.60413756  0.8504619  0.06980577</code></pre>
<p>Note how the correlations we calculated above are at the top left corner of the matrix. Also note that the diagonal of the matrix contains only 1s. This is because the correlation of a variable with itself is always 1 (because they are the exact same thing!). Finally, also note that column 1 row 2 has the same numbe as column 2 row 1. The same is true for column 1 row 3 and column 3 row 1, and so on. In fact, the section of the matrix above the diagonal (the “upper section”) is exactly the same as the section below the diagonal. Just as if we had placed a mirror in the diagonal and taken the mirror image. We call these type of matrices symmetric. Correlation matrices are always symmetric.</p>
<p>Remember that correlations go from -1 to 1. Negative correlations represent negative relationships, and the same is true for positive correlations. Thus, one way of finding out how similar each variable is to each of the other variables (how correlated they are) is by visualising this matrix. We can assign to each element of the matrix a color or the size of a circle. The plot generated is called a “correlation plot”.</p>
<p>To create a correlation plot in R, simply use the “corrplot()” function and specify where your correlations are stored, as follows.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="multivariate-data-analysis.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(corrmat)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
<p>Notice how the diagonal is full of ones (dark blue). The shading and the size of the circle are proportional to the correlation. This plot is also symetric, because correlation matrices are symmetric. Thus, we can eliminate one half of it without losing any information. Let’s keep only the upper part:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="multivariate-data-analysis.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(corrmat, <span class="at">type =</span> <span class="st">&quot;upper&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-208-1.png" width="672" /></p>
<p>Now we can at last start making sense of this multivariate data. We see, for example, that levels of Fe2O3 are correlated with almost everything else. When Fe2O3 increases, CaO also icreases, as well as Na2O and MnO. However, MgO and Al2O3 have a negative correlation: when one increses the other decreases. What else can you see?</p>
</div>
<div id="the-distance-matrix" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> The distance matrix<a href="multivariate-data-analysis.html#the-distance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As said before (and as discussed in previous sessios) each variable in our data set can be seen as a “dimension”. This has to do with data having “geomtric” properties. What this means is that our data set can be seen as a “space of 9 dimensions” where each of the pottery specimens is a dot with precise coordinates.</p>
<p>Because each row in our matrix can be thought of as a “point in space”, we can actually calculate the distance between any two points. This distance is impossible to visualise or imagine by human minds, because our own world only has a few dimensions and not 9, but this distance exists mathematically!</p>
<p>To calculate the distance between the pottery specimen 1 and 2 in this 9-dimensional space, for instance, we use the equation for Euclidean distances. This equation is one of the fundamentals of analytical geometry and comes from the pythagorean theorem, but we will not explain it in depth here.</p>
<p>The distance between pottery 1 and 2 is the following:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="multivariate-data-analysis.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>((pots[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>] <span class="sc">-</span> pots[<span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>])<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 2.924741</code></pre>
<p>And the distance between specimen 1 and 3 is as follows:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="multivariate-data-analysis.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>((pots[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>] <span class="sc">-</span> pots[<span class="dv">3</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>])<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1.986228</code></pre>
<p>Just like we did above with correlations, we can calculate the distance between all possible pairs of pottery specimens. These distances are, again, arrange into a matrix we call the “distance matrix”. R has an easy function to do that in just one line The function is called “dists()” and you only need to specify where your data is stored, as follows:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="multivariate-data-analysis.html#cb345-1" aria-hidden="true" tabindex="-1"></a>distmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(pots)</span></code></pre></div>
<p>Let’s look at the first 6 rows and columns of this distance matrix</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="multivariate-data-analysis.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(distmat)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<pre><code>##          1         2         3         4         5         6
## 1 0.000000 2.9247408 1.9862278 2.9665151 2.5016339 2.0789250
## 2 2.924741 0.0000000 1.3493762 0.1273460 0.9307723 1.9647203
## 3 1.986228 1.3493762 0.0000000 1.3717146 0.5909323 0.7228651
## 4 2.966515 0.1273460 1.3717146 0.0000000 0.9600542 1.9911768
## 5 2.501634 0.9307723 0.5909323 0.9600542 0.0000000 1.0743021
## 6 2.078925 1.9647203 0.7228651 1.9911768 1.0743021 0.0000000</code></pre>
<p>Just like with the correlation, the distance matrix is symetric. This is because the distance from speciment 1 to specimen 2 is the exact same as the distance between specimen 2 and speciment 1. Also, note that the diagonal is made of zeros. This is because the distance between a point and itself is always zero: they occupy the same position in space!</p>
</div>
<div id="clustering-and-dendrograms" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Clustering and dendrograms<a href="multivariate-data-analysis.html#clustering-and-dendrograms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use the matrix of distances to find which points are close to each other in space, and which are seaprate. What this tells us in the real world is which pieces of pottery are very similar to each other, and which are different. This process of identyfing “subgroups” or “substructures” in the data is called “clustering”.</p>
<p>One of the most common methods for clustering data is “hierarchical clustering”“, which works by building a dendrogram. A dendrogram is a type of tree (just like a family tree). In our case, we will build a tree in which each pot is closest to the most similar pot and farthest from the most dissimlar pot.</p>
<p>To do this in R we use the function hclust(). Let’s store the results in the variable “tree”.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="multivariate-data-analysis.html#cb348-1" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">hclust</span>(distmat)</span></code></pre></div>
<p>Now let’s plot the results:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="multivariate-data-analysis.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
<p>This plot tells us a lot about the data! In fact, you can see that there are three groups (three big branches in the tree). We call these groups “clusters”. Because we know that the pottery used for this study comes from three different areas of the UK, we can postulate that each of these three clusters may correspond to a different location. We have found which pots belong to which region!</p>
</div>
<div id="heatmaps" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Heatmaps<a href="multivariate-data-analysis.html#heatmaps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>However, in the tree above all we know is which pots belong to which group (or region). We do not know what characterises each pot: what makes Gloucester pottery different from Wales pottery? We cannot know. A way to gain more insights into this is by using a very creative type of visualisation: “heatmaps”.</p>
<p>Heatmaps are dendrograms (trees) in which, for each individual element (in this case, each piece of pottery), we also get to see the value of all the variables (in this case the levels of each chemical element). You might be surprised this is possible at all. Above, we tried all sorts of methods to look at this data and yet we could not see more than 3 variables at a time! So how do heatmaps achieve this?</p>
<p>The answer is that they cheat! They “deceive” our eyes. The way they do this is by assigning an order to colours. Colours do not have any natural order (blue is not bigger than green or yellow), but we can order them according to some scheme; for example, their position in the rainbow. A common practice is to say that blue is “lower” than “red” because blue is cold and red is hot (this is why they are called heatmaps). This is, of couse, arbitrary but it works surprisingly well! Now we can visualise each chemical element in each pot as a very thin stripe of colour. Because the pieces of pottery (and, in fact, the chemical compounds too) are ordered using a tree (hierarchical clustering) things which are similar will be close to each other in the plot. Putting similar things together helps our eyes detect patterns much better. In fact, patterns are amplified by the heatmap for us to see them.</p>
<p>Let’s use he pheatmap() funciton (phemap stands for “Pretty HEATMAPs”) to create a heatmap of our data. We will set the colours to go from blue (cold) to red (hot).</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="multivariate-data-analysis.html#cb350-1" aria-hidden="true" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>))(<span class="dv">1000</span>)</span>
<span id="cb350-2"><a href="multivariate-data-analysis.html#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(pots, <span class="at">scale =</span> <span class="st">&quot;column&quot;</span>, <span class="at">col=</span>mycolors, <span class="at">fontsize_row =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-215-1.png" width="672" /></p>
<p>Now we are getting a lot of useful information out of the data! We see that there are two clear groups of pots (which we believe correspond to the regions where the pottery comes from). Pots of the first region have relatively high levels of everything except aluminium and titanium oxides (Al2O3, Ti2O3). Pots of the second region contain high levels of magnesium, manganesum and potasium ozides (MnO, MgO, K2O) but lower levels of everyting else. Finally, pots from the third region contain high levels of almost everything (especially calcium oxide), but low levels of MnO, MgO and K2O.</p>
</div>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Exercises<a href="multivariate-data-analysis.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before going into the next section, you will have time to work on your project data. You can start by asking the following:</p>
<ol style="list-style-type: decimal">
<li>How many variables on your project data set are numerical? Which are these? You can focus on them. These will include the variables you looked at in previous sessions</li>
<li>For all these variables, create a scatter plot matrix. If possible, add a “best fit” line</li>
<li>Calculate the correlation and distnace matrices</li>
<li>Plot the correlations as a correlation plot. Which variables are related to each other?</li>
<li>Use the distance matrix to perform clustering and create a tree. Do you have any subgroups in your data?</li>
<li>Create a heatmap. What does this heatmap tell you about your data? Is this something you could’ve learnt from analysing the variables separately?</li>
</ol>
</div>
<div id="reducing-the-number-of-dimensions" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Reducing the number of dimensions<a href="multivariate-data-analysis.html#reducing-the-number-of-dimensions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous sections we used different techniques to analyse all the 9 variables in our data. However, sometimes this is impossible to do. What if we don’t have 9 or 10 or 15 but 150 or 15,000 variables? In big data this is common (hence the “big” in big data).</p>
<p>There is another way of analysing multiple variables in which, instead of analysing all of them, we “reduce them”. This means, we use the 9 or 10 or 100 dimensions we have to create just 2 or 3 new (and better) dimensions. These new dimensions are combinations of the original ones. This is analogous to creating new (better) axes by rotating our original axes around. In the theoretical part of this session you will learn in more detail what this means and how dimensions can be reduced. However, the mathematics behind this are quite complicated and thus will not be explained here.</p>
<p>The best known method for reducing dimensions is called “Principal Component Analysis” (PCA). To perform PCA in R you can use the function “prcomp()”. Let’s perform PCA on our data:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="multivariate-data-analysis.html#cb351-1" aria-hidden="true" tabindex="-1"></a>PCs <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(pots, <span class="at">scale. =</span> T)</span></code></pre></div>
<p>Now let’s have a look at the results:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="multivariate-data-analysis.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(PCs)</span></code></pre></div>
<pre><code>## Importance of components:
##                           PC1    PC2     PC3     PC4     PC5     PC6     PC7     PC8    PC9
## Standard deviation     2.0503 1.5885 0.93699 0.67538 0.61647 0.51840 0.34325 0.30190 0.2846
## Proportion of Variance 0.4671 0.2804 0.09755 0.05068 0.04223 0.02986 0.01309 0.01013 0.0090
## Cumulative Proportion  0.4671 0.7475 0.84501 0.89570 0.93792 0.96778 0.98087 0.99100 1.0000</code></pre>
<p>You will see that now, instead of the original 9 chemical compunds, we have 9 new dimensions. These dimensions are called “Principal Components” (PCs). You might think that this is not really a reduction, because we had 9 dimensions originally and we ended up with another 9! However, PCs are ordered by importance and most of the times you will not need more than the first two or three of them. For example, in this case PC1 and PC2 together already account for 74% (0.46 + 0.28) of the variance (differences we see) in our data. So plotting these two dimensions is almost equivalent to plotting the 9 original ones.</p>
<p>Let’s plot the first two PCs:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="multivariate-data-analysis.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PCs<span class="sc">$</span>x, <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
<p>We immediately see there are three groups of samples, which are probably the same we identified before with hierarchical clustering. You might be wondering what each of these PCs mean. What is a PC? How is it related to any of the chemical compounds we originally had? The answer depends on the data: PCs will have a different meaning for every data set you work with. Let’s find out what they mean in this specific example.</p>
<p>Above I mentioned that each PC is a different “combination” of the original 9 variables, in the output below we can see how much each compund is contributing to each of the PCs.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="multivariate-data-analysis.html#cb355-1" aria-hidden="true" tabindex="-1"></a>PCs</span></code></pre></div>
<pre><code>## Standard deviations (1, .., p=9):
## [1] 2.0503433 1.5884850 0.9369854 0.6753828 0.6164727 0.5183982 0.3432531 0.3019006 0.2845736
## 
## Rotation (n x k) = (9 x 9):
##               PC1         PC2          PC3         PC4         PC5          PC6          PC7         PC8         PC9
## Al2O3 -0.34829631  0.32780562  0.119014979 -0.03608198  0.32219091 -0.776136871 -0.017576097  0.21945465 -0.03319629
## Fe2O3  0.32709620  0.39525949 -0.264444108 -0.02114131  0.34343318 -0.045613182  0.243749457 -0.50439926  0.48222510
## MgO    0.43456923 -0.18964741  0.150918366  0.05350702  0.28126791 -0.009243254 -0.442140420  0.49189525  0.48259499
## CaO    0.06428531  0.50119655 -0.477928669 -0.49719394 -0.06858469  0.226593748 -0.171170581  0.39348466 -0.16992250
## Na2O   0.21717586  0.45551237 -0.007020976  0.57759974 -0.53034971 -0.157645754 -0.321107660 -0.04474717 -0.02090327
## K2O    0.45633257 -0.01837517  0.102097013 -0.03872041  0.38892815 -0.078842428 -0.309777858 -0.28554772 -0.66672244
## TiO2  -0.34019754  0.30078403  0.089583383  0.49161094  0.49299846  0.520801535 -0.005608328  0.14702257 -0.09032883
## MnO    0.45522720  0.08753781  0.140202878  0.15303057 -0.02199131 -0.048867577  0.718184163  0.42728179 -0.20199070
## BaO    0.01854192  0.37839957  0.791553826 -0.38466339 -0.13551441  0.198520122 -0.024441118 -0.11359903  0.10329608</code></pre>
<p>For example, PC2 (the vertical axis in our previous plot), which distinguishes one of the pottery regions from the other two, is mostly a combination of high CaO and Na2O, but low MgO and K2O. This probably corresponds to region number two in our heatmap (see above).</p>
<div id="combining-dimensionality-reduction-with-clustering" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Combining dimensionality reduction with clustering<a href="multivariate-data-analysis.html#combining-dimensionality-reduction-with-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s combine both of the approaches we’ve learnt. We first used the distance between pottery specimens to build a dendrogram or tree, in which we saw three different groups. This is our tree:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="multivariate-data-analysis.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree, <span class="at">main=</span><span class="st">&quot;Dendrogram of pottery samples&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
<p>Then we use PCA to reduce the dimensions and we also found three groups. These are the results:</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="multivariate-data-analysis.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PCs<span class="sc">$</span>x, <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
<p>Are these two results equivalent? Do they indicate the same 3 groups?</p>
<p>To verify this, let’s recover the three groups in our tree (dendrogram). If you look at the tree you’ll see that, if you “cut”/“slice” the branches of the tree close to height = 8, you get the tree groups. Let’s use the function “cutree()” to do this and store the results:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="multivariate-data-analysis.html#cb359-1" aria-hidden="true" tabindex="-1"></a>pot.types <span class="ot">&lt;-</span> <span class="fu">cutree</span>(tree, <span class="at">h=</span><span class="dv">8</span>)</span></code></pre></div>
<p>The result of this is a list of numbers which tell us which pot specimen belongs to which group (groups are 1, 2 and 3).</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="multivariate-data-analysis.html#cb360-1" aria-hidden="true" tabindex="-1"></a>pot.types</span></code></pre></div>
<pre><code>##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 
##  1  1  1  1  1  1  1  1  1  2  2  2  2  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  2  2  2  2  3  3  3  3  3  3  3  3  3  3</code></pre>
<p>Now let’s draw the PCA plot again, but adding these labels. Group 1 will be represented by points, group 2 by triangles and group 3 by crosses.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="multivariate-data-analysis.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(PCs<span class="sc">$</span>x), <span class="fu">aes</span>(PC1,PC2)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape=</span>pot.types, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<p>We see that the conclusions from both methods are ALMOST the same, though there are only 4 pieces of pottery that are classified into different groups/regions by the two methods.</p>
<p>Now you know how to reduce the dimensions of a data using PCA. This might still be confusing since dimensionality reduction is a difficult concept to grasp. However, in the next sessions there will be more exercises to help you understand how PCA is used to analyse multi-dimensional data.</p>
</div>
</div>
<div id="exercises-4" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Exercises<a href="multivariate-data-analysis.html#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You will now have some time to explore your project data. A good starting point would be:</p>
<ol style="list-style-type: decimal">
<li>Take the numeric variables you were working with before and perform PCA on them</li>
<li>Look at the PCs: how many will you need to summarise your data?</li>
<li>Plot the first two PCs. What do they tell you about the data? Do you need to plot any other PCs?</li>
<li>Look at the contribution of each variable to your PCs. What does each of your PCs mean?</li>
</ol>
</div>
<div id="references-1" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> References<a href="multivariate-data-analysis.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This session was based on fragments from the following book:</p>
<ol style="list-style-type: decimal">
<li>Everitt B, Hothorn T. (2011). An Introduction to applied multivariate analysis with R. London: Springer.</li>
<li>A. Tubb and N. J. Parker and G. Nickless (1980), The analysis of Romano-British pottery by atomic absorption spectrophotometry. Archaeometry, 22, 153–171.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bivariate-data-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="web-scraping-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Multivariate-data-analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
