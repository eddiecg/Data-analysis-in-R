<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Web scraping in R | Fundamentals of Data Analysis in R</title>
  <meta name="description" content="<p>This is a collection of tutorials that illustrate how to analyse data in R.
The topics touched on this collection span univariate data analysis, multivariate data analysis, and fundamentals of machine learning.</p>" />
  <meta name="generator" content="bookdown 0.28.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Web scraping in R | Fundamentals of Data Analysis in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a collection of tutorials that illustrate how to analyse data in R.
The topics touched on this collection span univariate data analysis, multivariate data analysis, and fundamentals of machine learning.</p>" />
  <meta name="github-repo" content="eddiecg/Data-analysis-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Web scraping in R | Fundamentals of Data Analysis in R" />
  
  <meta name="twitter:description" content="<p>This is a collection of tutorials that illustrate how to analyse data in R.
The topics touched on this collection span univariate data analysis, multivariate data analysis, and fundamentals of machine learning.</p>" />
  

<meta name="author" content="Eddie Cano-Gamez" />


<meta name="date" content="2022-08-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multivariate-data-analysis.html"/>
<link rel="next" href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamentals of Data Analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to Programming in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#calculations-in-r"><i class="fa fa-check"></i><b>1.1</b> Calculations in R</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#variable-assignation-in-r"><i class="fa fa-check"></i><b>1.2</b> Variable assignation in R</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#data-types-in-r"><i class="fa fa-check"></i><b>1.3</b> Data types in R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#numeric-variables"><i class="fa fa-check"></i><b>1.3.1</b> Numeric variables</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#character-variables"><i class="fa fa-check"></i><b>1.3.2</b> Character variables</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#logical-variables"><i class="fa fa-check"></i><b>1.3.3</b> Logical variables</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#categorical-variables-factors"><i class="fa fa-check"></i><b>1.3.4</b> Categorical variables (factors)</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#working-with-multiple-numbers-in-r"><i class="fa fa-check"></i><b>1.4</b> Working with multiple numbers in R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#vectors"><i class="fa fa-check"></i><b>1.4.1</b> Vectors</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#lists"><i class="fa fa-check"></i><b>1.4.2</b> Lists</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#matrices"><i class="fa fa-check"></i><b>1.4.3</b> Matrices</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#data-frames"><i class="fa fa-check"></i><b>1.4.4</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#manipulating-data-in-r"><i class="fa fa-check"></i><b>1.5</b> Manipulating data in R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#working-with-lists-of-data-frames"><i class="fa fa-check"></i><b>1.5.1</b> Working with lists of data frames</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#extending-rs-funcitonality-with-libraries"><i class="fa fa-check"></i><b>1.6</b> Extending R’s funcitonality with libraries</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#writing-data-from-r"><i class="fa fa-check"></i><b>1.7</b> Writing data from R</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#writing-human-readable-files"><i class="fa fa-check"></i><b>1.7.1</b> Writing human readable files</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#writing-binary-files"><i class="fa fa-check"></i><b>1.7.2</b> Writing binary files</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>1.8</b> Reading data into R</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-programming-in-r.html"><a href="introduction-to-programming-in-r.html#project-work"><i class="fa fa-check"></i><b>1.9</b> Project work</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html"><i class="fa fa-check"></i><b>2</b> Univariate Data Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#visualising-univariate-data"><i class="fa fa-check"></i><b>2.1</b> Visualising univariate data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#dot-plot-strip-chart"><i class="fa fa-check"></i><b>2.1.1</b> Dot plot / Strip chart</a></li>
<li class="chapter" data-level="2.1.2" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#histograms"><i class="fa fa-check"></i><b>2.1.2</b> Histograms</a></li>
<li class="chapter" data-level="2.1.3" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#density-plot"><i class="fa fa-check"></i><b>2.1.3</b> Density plot</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#summarising-univariate-data"><i class="fa fa-check"></i><b>2.2</b> Summarising univariate data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#mean"><i class="fa fa-check"></i><b>2.2.1</b> Mean</a></li>
<li class="chapter" data-level="2.2.2" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#median"><i class="fa fa-check"></i><b>2.2.2</b> Median</a></li>
<li class="chapter" data-level="2.2.3" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#quantiles"><i class="fa fa-check"></i><b>2.2.3</b> Quantiles</a></li>
<li class="chapter" data-level="2.2.4" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#standard-deviation"><i class="fa fa-check"></i><b>2.2.4</b> Standard deviation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#comparing-data-to-probability-distributions"><i class="fa fa-check"></i><b>2.3</b> Comparing data to probability distributions</a></li>
<li class="chapter" data-level="2.4" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#box-plots"><i class="fa fa-check"></i><b>2.4</b> Box plots</a></li>
<li class="chapter" data-level="2.5" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#data-as-a-random-sample"><i class="fa fa-check"></i><b>2.5</b> Data as a random sample</a></li>
<li class="chapter" data-level="2.6" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#exercises"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
<li class="chapter" data-level="2.7" data-path="univariate-data-analysis.html"><a href="univariate-data-analysis.html#references"><i class="fa fa-check"></i><b>2.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Bivariate Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#visualising-two-variables"><i class="fa fa-check"></i><b>3.1</b> Visualising two variables</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#scatter-plot"><i class="fa fa-check"></i><b>3.1.1</b> Scatter plot</a></li>
<li class="chapter" data-level="3.1.2" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#bivariate-box-plots"><i class="fa fa-check"></i><b>3.1.2</b> Bivariate box plots</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#applying-transformations-to-a-variable"><i class="fa fa-check"></i><b>3.2</b> Applying transformations to a variable</a></li>
<li class="chapter" data-level="3.3" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#using-ggplot2-to-create-personalised-plots"><i class="fa fa-check"></i><b>3.3</b> Using ggplot2 to create personalised plots</a></li>
<li class="chapter" data-level="3.4" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
<li class="chapter" data-level="3.5" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#covariance"><i class="fa fa-check"></i><b>3.5</b> Covariance</a></li>
<li class="chapter" data-level="3.6" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#correlation"><i class="fa fa-check"></i><b>3.6</b> Correlation</a></li>
<li class="chapter" data-level="3.7" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#predictions-and-linear-models"><i class="fa fa-check"></i><b>3.7</b> Predictions and linear models</a></li>
<li class="chapter" data-level="3.8" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#correlation-does-not-equal-causation"><i class="fa fa-check"></i><b>3.8</b> Correlation does not equal causation</a></li>
<li class="chapter" data-level="3.9" data-path="bivariate-data-analysis.html"><a href="bivariate-data-analysis.html#exercises-2"><i class="fa fa-check"></i><b>3.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Multivariate Data Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#exploring-one-variable-at-a-time"><i class="fa fa-check"></i><b>4.1</b> Exploring one variable at a time</a></li>
<li class="chapter" data-level="4.2" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#analysing-all-variables-jointly"><i class="fa fa-check"></i><b>4.2</b> Analysing all variables jointly</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#scatter-plot-matrices"><i class="fa fa-check"></i><b>4.2.1</b> Scatter plot matrices</a></li>
<li class="chapter" data-level="4.2.2" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#correlation-plots"><i class="fa fa-check"></i><b>4.2.2</b> Correlation plots</a></li>
<li class="chapter" data-level="4.2.3" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#the-distance-matrix"><i class="fa fa-check"></i><b>4.2.3</b> The distance matrix</a></li>
<li class="chapter" data-level="4.2.4" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#clustering-and-dendrograms"><i class="fa fa-check"></i><b>4.2.4</b> Clustering and dendrograms</a></li>
<li class="chapter" data-level="4.2.5" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#heatmaps"><i class="fa fa-check"></i><b>4.2.5</b> Heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#exercises-3"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
<li class="chapter" data-level="4.4" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#reducing-the-number-of-dimensions"><i class="fa fa-check"></i><b>4.4</b> Reducing the number of dimensions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#combining-dimensionality-reduction-with-clustering"><i class="fa fa-check"></i><b>4.4.1</b> Combining dimensionality reduction with clustering</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#exercises-4"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
<li class="chapter" data-level="4.6" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#references-1"><i class="fa fa-check"></i><b>4.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html"><i class="fa fa-check"></i><b>5</b> Web scraping in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#example-scraping-the-imdb-website"><i class="fa fa-check"></i><b>5.1</b> Example: Scraping the IMDB website</a></li>
<li class="chapter" data-level="5.2" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#extracting-variables-using-css-selectors"><i class="fa fa-check"></i><b>5.2</b> Extracting variables using CSS selectors</a></li>
<li class="chapter" data-level="5.3" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#scraping-multiple-fields-from-a-website"><i class="fa fa-check"></i><b>5.3</b> Scraping multiple fields from a website</a></li>
<li class="chapter" data-level="5.4" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#performing-exploratory-data-analysis-eda-on-scraped-data"><i class="fa fa-check"></i><b>5.4</b> Performing exploratory data analysis (EDA) on scraped data</a></li>
<li class="chapter" data-level="5.5" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#exercises-5"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
<li class="chapter" data-level="5.6" data-path="web-scraping-in-r.html"><a href="web-scraping-in-r.html#references-2"><i class="fa fa-check"></i><b>5.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><i class="fa fa-check"></i><b>6</b> Machine Learning Fundamentals: Spam Detection Using a Naive Bayes Classifier</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#visualising-data"><i class="fa fa-check"></i><b>6.1</b> Visualising data</a></li>
<li class="chapter" data-level="6.2" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#pre-processing-data"><i class="fa fa-check"></i><b>6.2</b> Pre-processing data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#converting-data-to-corpus"><i class="fa fa-check"></i><b>6.2.1</b> Converting data to corpus</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#cleaning-data"><i class="fa fa-check"></i><b>6.2.2</b> Cleaning data</a></li>
<li class="chapter" data-level="6.2.3" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#visualising-clean-data"><i class="fa fa-check"></i><b>6.2.3</b> Visualising clean data</a></li>
<li class="chapter" data-level="6.2.4" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#tokenising"><i class="fa fa-check"></i><b>6.2.4</b> Tokenising</a></li>
<li class="chapter" data-level="6.2.5" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#dividing-data-into-training-and-testing-set"><i class="fa fa-check"></i><b>6.2.5</b> Dividing data into training and testing set</a></li>
<li class="chapter" data-level="6.2.6" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#correcting-data-sparsity"><i class="fa fa-check"></i><b>6.2.6</b> Correcting data sparsity</a></li>
<li class="chapter" data-level="6.2.7" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#converting-data-to-word-appearance-table"><i class="fa fa-check"></i><b>6.2.7</b> Converting data to word appearance table</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#predicting-spam-and-non-spam"><i class="fa fa-check"></i><b>6.3</b> Predicting spam and non-spam</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#training-classifier"><i class="fa fa-check"></i><b>6.3.1</b> Training classifier</a></li>
<li class="chapter" data-level="6.3.2" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#testing-classifier"><i class="fa fa-check"></i><b>6.3.2</b> Testing classifier</a></li>
<li class="chapter" data-level="6.3.3" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#evaluating-performance"><i class="fa fa-check"></i><b>6.3.3</b> Evaluating performance</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#discussion"><i class="fa fa-check"></i><b>6.4</b> Discussion</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html"><a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html#references-3"><i class="fa fa-check"></i><b>6.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Fundamentals: Predicting Variables Using Neural Networks</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#normalising-data"><i class="fa fa-check"></i><b>7.1</b> Normalising data</a></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#visualising-data-1"><i class="fa fa-check"></i><b>7.2</b> Visualising data</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#creating-neural-network"><i class="fa fa-check"></i><b>7.3</b> Creating neural network</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#spliting-data-into-training-and-testing-sets"><i class="fa fa-check"></i><b>7.3.1</b> Spliting data into training and testing sets</a></li>
<li class="chapter" data-level="7.3.2" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#training-neural-network"><i class="fa fa-check"></i><b>7.3.2</b> Training neural network</a></li>
<li class="chapter" data-level="7.3.3" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#testing-neural-network"><i class="fa fa-check"></i><b>7.3.3</b> Testing neural network</a></li>
<li class="chapter" data-level="7.3.4" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#evaluating-performance-1"><i class="fa fa-check"></i><b>7.3.4</b> Evaluating performance</a></li>
<li class="chapter" data-level="7.3.5" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#improving-performance-by-adding-hidden-nodes"><i class="fa fa-check"></i><b>7.3.5</b> Improving performance by adding hidden nodes</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#conclusions"><i class="fa fa-check"></i><b>7.4</b> Conclusions</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-fundamentals-predicting-variables-using-neural-networks.html"><a href="machine-learning-fundamentals-predicting-variables-using-neural-networks.html#references-4"><i class="fa fa-check"></i><b>7.5</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fundamentals of Data Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="web-scraping-in-r" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Web scraping in R<a href="web-scraping-in-r.html#web-scraping-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>During this session, we will learn how to use R to perform “web scraping”. Web scraping, aslfo called web harvesting, is the extraction of data from websites in an ordered and structured manner. We have all done web scraping in its simplest form: simply “copying and pasting”. However, sometimes the information on a website is extremely unstructured (buried in the text or in formats which are difficult to interpret), and it would be time consuming to copy and paste all the information we need by hand. Furthermore, often we need to scrape not one but tends or hundreds of aspects of a website; and often this has to be repeated for multiple websites too. Hence, developing methods for atuomated web scraping is central in big data and data analysis.</p>
<p>The R package “rvest” can be used for web scraping. Let’s first install it. We will also install “wordcloud”, which can be used for processing text data.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="web-scraping-in-r.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;rvest&quot;</span>)</span>
<span id="cb363-2"><a href="web-scraping-in-r.html#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;wordcloud&quot;</span>)</span></code></pre></div>
<p>Now let’s load it. We will also load the ggplot2 and ggrepel packages for data visualisation.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="web-scraping-in-r.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb364-2"><a href="web-scraping-in-r.html#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb364-3"><a href="web-scraping-in-r.html#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb364-4"><a href="web-scraping-in-r.html#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span></code></pre></div>
<p>For eficient web scraping, you will need the “Selector Gadget”. Make sure you have a working version of Google Chrome installed. Next, use Chrome to open the following link:</p>
<p><a href="https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb?hl=en" class="uri">https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb?hl=en</a></p>
<p>Finally, click the “Add to chrome” buttom, it should only take a few seconds. Now the Selector Gadget is ready to use.</p>
<div id="example-scraping-the-imdb-website" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Example: Scraping the IMDB website<a href="web-scraping-in-r.html#example-scraping-the-imdb-website" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the purpose of this tutorial, we will be scraping the IMDB website, which contains raiting and information for films. Let’s focus specifically on the following website, which contains the 100 most popular films released between January and December 2016:</p>
<p><a href="http://www.imdb.com/search/title?count=100&amp;release_date=2016,2016&amp;title_type=feature" class="uri">http://www.imdb.com/search/title?count=100&amp;release_date=2016,2016&amp;title_type=feature</a></p>
<p>Take some time to explore the website and its metrics. Notice that, for each film, IMDB contains information such as its title, portrait, rating, staring actors, rank, genre, duration, etc…</p>
<p>The first fact we have to realise is that websites are simply files, just as our word files or spreadsheets are files. They are files written in the “hyper-text markup language” (html). Every time we access a website, we specify our computer the location of such file via a “Uniform resource locator” (URL) and the computer displays the file using a browser (Chrome, Safari, Firefox, etc…). Browsers simply translate the HTML language to something easy for us to visualise: an arrangement of images, colours, text, links, and other objects.</p>
<p>We can easily open html files in R just as we have previously opened spreadsheets (CSV files), text files or tables. We use the function “read_html()”, which is part of the rvest package. Let’s read the top 100 2016 IMDB films website into R. We’ll assign the content to a variable called “webpage”.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="web-scraping-in-r.html#cb365-1" aria-hidden="true" tabindex="-1"></a>webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;http://www.imdb.com/search/title?count=100&amp;release_date=2016,2016&amp;title_type=feature&quot;</span>)</span></code></pre></div>
<p>Let’s look at the content of “webpage”:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="web-scraping-in-r.html#cb366-1" aria-hidden="true" tabindex="-1"></a>webpage</span></code></pre></div>
<pre><code>## {html_document}
## &lt;html xmlns:og=&quot;http://ogp.me/ns#&quot; xmlns:fb=&quot;http://www.facebook.com/2008/fbml&quot;&gt;
## [1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;\n&lt;script type=&quot;text/javascript&quot;&gt;var ue_t0=ue_t0||+new Date();&lt;/script&gt;&lt;script type=&quot;text/jav ...
## [2] &lt;body id=&quot;styleguide-v2&quot; class=&quot;fixed&quot;&gt;\n            &lt;img height=&quot;1&quot; width=&quot;1&quot; style=&quot;display:none;visibility:hidden;&quot; src=&quot;//fls-na.amazon.com/1/batch/1/OP/A1EVAM02EL8 ...</code></pre>
<p>Note that it is an xml document and that it contains several fields, written in HTML (HTML is a language characterised by a lot of &lt; &gt; symbols). Inside this variable is contained all the information we can see when scrolling in our browser.</p>
</div>
<div id="extracting-variables-using-css-selectors" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Extracting variables using CSS selectors<a href="web-scraping-in-r.html#extracting-variables-using-css-selectors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’ move to Chrome. We will use Chrome’s “Selector Gadget”” to retrieve specific fields/variables from the website. To activate the selector gadget, click on the magnifying glass at the top right corner of the browser. Now, if you move your pointer around the website, you will see different sections being highlighted. Find any section that interests you (for example, one of the pirctureS) and click on it. You will see that a string of text appears in the bottom right corner of the screen. This text is called the “CSS selector”. You can think of CSS selectors as “unique identifiers” of specific elements on a website. For example, you’ll notice that when you clicked the film’s image all the other images were also highlighted. This is because that CSS elector identifies ALL the film covers. This is useful because we can use this text to extract all of them, instead of copying and pasting 100 images one by one. Let’s apply this to web scraping.</p>
<ol style="list-style-type: decimal">
<li><p>Using the Selector Gadget, click on the title of the first film. You should see the entirety of he title highlighted in yellow. The text “.lister-item-header” will appear at the bottom right. This is the CSS selector for movie titles. Copy that text.</p></li>
<li><p>Now use the function “html_nodes” and specify that you want to extract the film titles by pasting the CSS selector, as follows:</p></li>
</ol>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="web-scraping-in-r.html#cb368-1" aria-hidden="true" tabindex="-1"></a>title_data_html <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(webpage,<span class="st">&#39;.lister-item-header a&#39;</span>)</span></code></pre></div>
<p>The titles have now been scraped! Let’s see how they look:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="web-scraping-in-r.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(title_data_html)</span></code></pre></div>
<pre><code>## {xml_nodeset (6)}
## [1] &lt;a href=&quot;/title/tt1431045/?ref_=adv_li_tt&quot;&gt;Deadpool&lt;/a&gt;
## [2] &lt;a href=&quot;/title/tt3748528/?ref_=adv_li_tt&quot;&gt;Rogue One&lt;/a&gt;
## [3] &lt;a href=&quot;/title/tt1386697/?ref_=adv_li_tt&quot;&gt;Suicide Squad&lt;/a&gt;
## [4] &lt;a href=&quot;/title/tt1211837/?ref_=adv_li_tt&quot;&gt;Doctor Strange&lt;/a&gt;
## [5] &lt;a href=&quot;/title/tt3783958/?ref_=adv_li_tt&quot;&gt;La La Land&lt;/a&gt;
## [6] &lt;a href=&quot;/title/tt3799694/?ref_=adv_li_tt&quot;&gt;The Nice Guys&lt;/a&gt;</code></pre>
<p>We cannot understand anything because they are in HTML language! Let’s convert them to normal textusing the function “html_text()”. We’ll store these titles in the variable “title_data”.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="web-scraping-in-r.html#cb371-1" aria-hidden="true" tabindex="-1"></a>title_data <span class="ot">&lt;-</span> <span class="fu">html_text</span>(title_data_html)</span></code></pre></div>
<p>Now they are understandable to us:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="web-scraping-in-r.html#cb372-1" aria-hidden="true" tabindex="-1"></a>title_data</span></code></pre></div>
<pre><code>##   [1] &quot;Deadpool&quot;                                              &quot;Rogue One&quot;                                             &quot;Suicide Squad&quot;                                        
##   [4] &quot;Doctor Strange&quot;                                        &quot;La La Land&quot;                                            &quot;The Nice Guys&quot;                                        
##   [7] &quot;Moana&quot;                                                 &quot;Hacksaw Ridge&quot;                                         &quot;Sing&quot;                                                 
##  [10] &quot;Arrival&quot;                                               &quot;Captain America: Civil War&quot;                            &quot;Nocturnal Animals&quot;                                    
##  [13] &quot;The Handmaiden&quot;                                        &quot;X-Men: Apocalypse&quot;                                     &quot;Split&quot;                                                
##  [16] &quot;10 Cloverfield Lane&quot;                                   &quot;Fantastic Beasts and Where to Find Them&quot;               &quot;Me Before You&quot;                                        
##  [19] &quot;Zootropolis&quot;                                           &quot;War Dogs&quot;                                              &quot;Hell or High Water&quot;                                   
##  [22] &quot;High Strung&quot;                                           &quot;Batman v Superman: Dawn of Justice&quot;                    &quot;Train to Busan&quot;                                       
##  [25] &quot;Your Name.&quot;                                            &quot;Gods of Egypt&quot;                                         &quot;Passengers&quot;                                           
##  [28] &quot;Hidden Figures&quot;                                        &quot;Captain Fantastic&quot;                                     &quot;Jason Bourne&quot;                                         
##  [31] &quot;13 Hours&quot;                                              &quot;The Huntsman: Winter&#39;s War&quot;                            &quot;Below Her Mouth&quot;                                      
##  [34] &quot;Star Trek Beyond&quot;                                      &quot;Ghostbusters&quot;                                          &quot;Central Intelligence&quot;                                 
##  [37] &quot;Don&#39;t Breathe&quot;                                         &quot;Manchester by the Sea&quot;                                 &quot;The Conjuring 2&quot;                                      
##  [40] &quot;The Neon Demon&quot;                                        &quot;The Accountant&quot;                                        &quot;Swiss Army Man&quot;                                       
##  [43] &quot;Moonlight&quot;                                             &quot;Miss Peregrine&#39;s Home for Peculiar Children&quot;           &quot;The Shallows&quot;                                         
##  [46] &quot;Lion&quot;                                                  &quot;Independence Day: Resurgence&quot;                          &quot;Assassin&#39;s Creed&quot;                                     
##  [49] &quot;Terrifier&quot;                                             &quot;Hush&quot;                                                  &quot;Warcraft: The Beginning&quot;                              
##  [52] &quot;The Magnificent Seven&quot;                                 &quot;Raw&quot;                                                   &quot;Silence&quot;                                              
##  [55] &quot;Sausage Party&quot;                                         &quot;Love Machine&quot;                                          &quot;Allied&quot;                                               
##  [58] &quot;Why Him?&quot;                                              &quot;The Founder&quot;                                           &quot;A Cure for Wellness&quot;                                  
##  [61] &quot;Jack Reacher: Never Go Back&quot;                           &quot;Hunt for the Wilderpeople&quot;                             &quot;Dirty Grandpa&quot;                                        
##  [64] &quot;The Wailing&quot;                                           &quot;The Lost City of Z&quot;                                    &quot;The Autopsy of Jane Doe&quot;                              
##  [67] &quot;The Jungle Book&quot;                                       &quot;Allegiant&quot;                                             &quot;The Girl on the Train&quot;                                
##  [70] &quot;Teenage Mutant Ninja Turtles: Out of the Shadows&quot;      &quot;The Invisible Guest&quot;                                   &quot;Batman v Superman: Dawn of Justice - Ultimate Edition&quot;
##  [73] &quot;Resident Evil: The Final Chapter&quot;                      &quot;The Great Wall&quot;                                        &quot;My Big Fat Greek Wedding 2&quot;                           
##  [76] &quot;The Legend of Tarzan&quot;                                  &quot;Sully: Miracle on the Hudson&quot;                          &quot;The Edge of Seventeen&quot;                                
##  [79] &quot;The Bad Batch&quot;                                         &quot;Now You See Me 2&quot;                                      &quot;Handsome Devil&quot;                                       
##  [82] &quot;The Secret Life of Pets&quot;                               &quot;Inferno&quot;                                               &quot;Kung Fu Panda 3&quot;                                      
##  [85] &quot;The 5th Wave&quot;                                          &quot;Lights Out&quot;                                            &quot;Grimsby&quot;                                              
##  [88] &quot;London Has Fallen&quot;                                     &quot;The Boy&quot;                                               &quot;Everybody Wants Some!!&quot;                               
##  [91] &quot;Lady Macbeth&quot;                                          &quot;A Silent Voice&quot;                                        &quot;Finding Dory&quot;                                         
##  [94] &quot;Deepwater Horizon&quot;                                     &quot;Brimstone&quot;                                             &quot;The Take&quot;                                             
##  [97] &quot;Jackie&quot;                                                &quot;How to Be Single&quot;                                      &quot;Hail, Caesar!&quot;                                        
## [100] &quot;Keanu&quot;</code></pre>
</div>
<div id="scraping-multiple-fields-from-a-website" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Scraping multiple fields from a website<a href="web-scraping-in-r.html#scraping-multiple-fields-from-a-website" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>A) IMDB ranking:</strong></p>
<p>Now we have the titles for the top 100 2016 IMDB films, but if we want to do any serious analysis on them we will need more data. Let’s repeat the previous process and use CSS selectors to scrap more fields. We start by scraping the rankings:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="web-scraping-in-r.html#cb374-1" aria-hidden="true" tabindex="-1"></a>rank_data_html <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(webpage,<span class="st">&#39;.text-primary&#39;</span>)</span></code></pre></div>
<p>We convert the rankings from html to text in the same way we did above:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="web-scraping-in-r.html#cb375-1" aria-hidden="true" tabindex="-1"></a>rank_data <span class="ot">&lt;-</span> <span class="fu">html_text</span>(rank_data_html)</span></code></pre></div>
<p>However, note that the rankings shouldn’t really be text, but numbers.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="web-scraping-in-r.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rank_data)</span></code></pre></div>
<pre><code>## [1] &quot;1.&quot; &quot;2.&quot; &quot;3.&quot; &quot;4.&quot; &quot;5.&quot; &quot;6.&quot;</code></pre>
<p>Let’s use as.numeric() to convert them into nummeric variables. We’ll store this in the variable “rank_data”.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="web-scraping-in-r.html#cb378-1" aria-hidden="true" tabindex="-1"></a>rank_data <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(rank_data)</span></code></pre></div>
<p>Now they look better.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="web-scraping-in-r.html#cb379-1" aria-hidden="true" tabindex="-1"></a>rank_data</span></code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42
##  [43]  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84
##  [85]  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100</code></pre>
<p><strong>B) Film duration:</strong></p>
<p>Let’s repeat the same process to extrac the duration of each film, which in IMDB is called “runtime”.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="web-scraping-in-r.html#cb381-1" aria-hidden="true" tabindex="-1"></a>runtime_data_html <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(webpage,<span class="st">&#39;.runtime&#39;</span>)</span>
<span id="cb381-2"><a href="web-scraping-in-r.html#cb381-2" aria-hidden="true" tabindex="-1"></a>runtime_data <span class="ot">&lt;-</span> <span class="fu">html_text</span>(runtime_data_html)</span>
<span id="cb381-3"><a href="web-scraping-in-r.html#cb381-3" aria-hidden="true" tabindex="-1"></a>runtime_data</span></code></pre></div>
<pre><code>##   [1] &quot;108 min&quot; &quot;133 min&quot; &quot;123 min&quot; &quot;115 min&quot; &quot;128 min&quot; &quot;116 min&quot; &quot;107 min&quot; &quot;139 min&quot; &quot;108 min&quot; &quot;116 min&quot; &quot;147 min&quot; &quot;116 min&quot; &quot;145 min&quot; &quot;144 min&quot; &quot;117 min&quot; &quot;103 min&quot; &quot;132 min&quot;
##  [18] &quot;106 min&quot; &quot;108 min&quot; &quot;114 min&quot; &quot;102 min&quot; &quot;96 min&quot;  &quot;152 min&quot; &quot;118 min&quot; &quot;106 min&quot; &quot;127 min&quot; &quot;116 min&quot; &quot;127 min&quot; &quot;118 min&quot; &quot;123 min&quot; &quot;144 min&quot; &quot;114 min&quot; &quot;94 min&quot;  &quot;122 min&quot;
##  [35] &quot;117 min&quot; &quot;107 min&quot; &quot;88 min&quot;  &quot;137 min&quot; &quot;134 min&quot; &quot;117 min&quot; &quot;128 min&quot; &quot;97 min&quot;  &quot;111 min&quot; &quot;127 min&quot; &quot;86 min&quot;  &quot;118 min&quot; &quot;120 min&quot; &quot;115 min&quot; &quot;82 min&quot;  &quot;82 min&quot;  &quot;123 min&quot;
##  [52] &quot;132 min&quot; &quot;99 min&quot;  &quot;161 min&quot; &quot;89 min&quot;  &quot;79 min&quot;  &quot;124 min&quot; &quot;111 min&quot; &quot;115 min&quot; &quot;146 min&quot; &quot;118 min&quot; &quot;101 min&quot; &quot;102 min&quot; &quot;156 min&quot; &quot;141 min&quot; &quot;86 min&quot;  &quot;106 min&quot; &quot;120 min&quot;
##  [69] &quot;112 min&quot; &quot;112 min&quot; &quot;106 min&quot; &quot;182 min&quot; &quot;107 min&quot; &quot;103 min&quot; &quot;94 min&quot;  &quot;110 min&quot; &quot;96 min&quot;  &quot;104 min&quot; &quot;118 min&quot; &quot;129 min&quot; &quot;95 min&quot;  &quot;87 min&quot;  &quot;121 min&quot; &quot;95 min&quot;  &quot;112 min&quot;
##  [86] &quot;81 min&quot;  &quot;83 min&quot;  &quot;99 min&quot;  &quot;97 min&quot;  &quot;117 min&quot; &quot;89 min&quot;  &quot;130 min&quot; &quot;97 min&quot;  &quot;107 min&quot; &quot;148 min&quot; &quot;92 min&quot;  &quot;100 min&quot; &quot;110 min&quot; &quot;106 min&quot; &quot;100 min&quot;</code></pre>
<p>Again, this variable isn’t really a text but a number (number of minutes). Let’s first remove the text ” minute” from every element using gsub().</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="web-scraping-in-r.html#cb383-1" aria-hidden="true" tabindex="-1"></a>runtime_data <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot; min&quot;</span>,<span class="st">&quot;&quot;</span>,runtime_data)</span></code></pre></div>
<p>Now let’s transform the text to nummeric and store it in the variable “runtime_data”.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="web-scraping-in-r.html#cb384-1" aria-hidden="true" tabindex="-1"></a>runtime_data<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(runtime_data)</span></code></pre></div>
<p>It looks much better!</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="web-scraping-in-r.html#cb385-1" aria-hidden="true" tabindex="-1"></a>runtime_data</span></code></pre></div>
<pre><code>##   [1] 108 133 123 115 128 116 107 139 108 116 147 116 145 144 117 103 132 106 108 114 102  96 152 118 106 127 116 127 118 123 144 114  94 122 117 107  88 137 134 117 128  97
##  [43] 111 127  86 118 120 115  82  82 123 132  99 161  89  79 124 111 115 146 118 101 102 156 141  86 106 120 112 112 106 182 107 103  94 110  96 104 118 129  95  87 121  95
##  [85] 112  81  83  99  97 117  89 130  97 107 148  92 100 110 106 100</code></pre>
<p><strong>C) Film genre:</strong></p>
<p>Now let’s scrape the genre of each movie.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="web-scraping-in-r.html#cb387-1" aria-hidden="true" tabindex="-1"></a>genre_data_html <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(webpage,<span class="st">&#39;.genre&#39;</span>)</span>
<span id="cb387-2"><a href="web-scraping-in-r.html#cb387-2" aria-hidden="true" tabindex="-1"></a>genre_data <span class="ot">&lt;-</span> <span class="fu">html_text</span>(genre_data_html)</span></code></pre></div>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="web-scraping-in-r.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(genre_data)</span></code></pre></div>
<pre><code>## [1] &quot;\nAction, Adventure, Comedy            &quot;  &quot;\nAction, Adventure, Sci-Fi            &quot;  &quot;\nAction, Adventure, Fantasy            &quot; &quot;\nAction, Adventure, Fantasy            &quot;
## [5] &quot;\nComedy, Drama, Music            &quot;       &quot;\nAction, Comedy, Crime            &quot;</code></pre>
<p>There are several problems here: firstly, there is a lot of extra space. Secondly, all the genres start with the new line () symbol. Finally, there are multiple genres for each film. Let’s fix these issues one by one.</p>
<p>First, we remove the new line symbols using gsub().</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="web-scraping-in-r.html#cb390-1" aria-hidden="true" tabindex="-1"></a>genre_data<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;&quot;</span>,genre_data)</span></code></pre></div>
<p>Next, we do the same to remove empty spaces.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="web-scraping-in-r.html#cb391-1" aria-hidden="true" tabindex="-1"></a>genre_data<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>,<span class="st">&quot;&quot;</span>,genre_data)</span></code></pre></div>
<p>Finally, let’s use gsub() to remove all the additional genres. We only keep the first one for each film.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="web-scraping-in-r.html#cb392-1" aria-hidden="true" tabindex="-1"></a>genre_data<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">&quot;,.*&quot;</span>,<span class="st">&quot;&quot;</span>,genre_data)</span>
<span id="cb392-2"><a href="web-scraping-in-r.html#cb392-2" aria-hidden="true" tabindex="-1"></a>genre_data</span></code></pre></div>
<pre><code>##   [1] &quot;Action&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Comedy&quot;    &quot;Action&quot;    &quot;Animation&quot; &quot;Biography&quot; &quot;Animation&quot; &quot;Drama&quot;     &quot;Action&quot;    &quot;Drama&quot;     &quot;Drama&quot;     &quot;Action&quot;   
##  [15] &quot;Horror&quot;    &quot;Drama&quot;     &quot;Adventure&quot; &quot;Drama&quot;     &quot;Animation&quot; &quot;Biography&quot; &quot;Crime&quot;     &quot;Drama&quot;     &quot;Action&quot;    &quot;Action&quot;    &quot;Animation&quot; &quot;Action&quot;    &quot;Drama&quot;     &quot;Biography&quot;
##  [29] &quot;Comedy&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Drama&quot;     &quot;Action&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Crime&quot;     &quot;Drama&quot;     &quot;Horror&quot;    &quot;Horror&quot;    &quot;Action&quot;    &quot;Comedy&quot;   
##  [43] &quot;Drama&quot;     &quot;Adventure&quot; &quot;Action&quot;    &quot;Biography&quot; &quot;Action&quot;    &quot;Action&quot;    &quot;Horror&quot;    &quot;Horror&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Drama&quot;     &quot;Drama&quot;     &quot;Animation&quot; &quot;Drama&quot;    
##  [57] &quot;Action&quot;    &quot;Comedy&quot;    &quot;Biography&quot; &quot;Drama&quot;     &quot;Action&quot;    &quot;Adventure&quot; &quot;Comedy&quot;    &quot;Drama&quot;     &quot;Adventure&quot; &quot;Horror&quot;    &quot;Adventure&quot; &quot;Action&quot;    &quot;Crime&quot;     &quot;Action&quot;   
##  [71] &quot;Crime&quot;     &quot;Action&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Comedy&quot;    &quot;Action&quot;    &quot;Biography&quot; &quot;Comedy&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Comedy&quot;    &quot;Animation&quot; &quot;Action&quot;    &quot;Animation&quot;
##  [85] &quot;Action&quot;    &quot;Horror&quot;    &quot;Action&quot;    &quot;Action&quot;    &quot;Horror&quot;    &quot;Comedy&quot;    &quot;Drama&quot;     &quot;Animation&quot; &quot;Animation&quot; &quot;Action&quot;    &quot;Drama&quot;     &quot;Action&quot;    &quot;Biography&quot; &quot;Comedy&quot;   
##  [99] &quot;Comedy&quot;    &quot;Action&quot;</code></pre>
<p>But perhaps text is not the best way to store this information. It is, in the end, a list with categories. It would be much better to have this as a factor variable. We thus convert it into a factor.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="web-scraping-in-r.html#cb394-1" aria-hidden="true" tabindex="-1"></a>genre_data<span class="ot">&lt;-</span><span class="fu">as.factor</span>(genre_data)</span></code></pre></div>
<p>Now it looks much better!</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="web-scraping-in-r.html#cb395-1" aria-hidden="true" tabindex="-1"></a>genre_data</span></code></pre></div>
<pre><code>##   [1] Action    Action    Action    Action    Comedy    Action    Animation Biography Animation Drama     Action    Drama     Drama     Action    Horror    Drama     Adventure
##  [18] Drama     Animation Biography Crime     Drama     Action    Action    Animation Action    Drama     Biography Comedy    Action    Action    Action    Drama     Action   
##  [35] Action    Action    Crime     Drama     Horror    Horror    Action    Comedy    Drama     Adventure Action    Biography Action    Action    Horror    Horror    Action   
##  [52] Action    Drama     Drama     Animation Drama     Action    Comedy    Biography Drama     Action    Adventure Comedy    Drama     Adventure Horror    Adventure Action   
##  [69] Crime     Action    Crime     Action    Action    Action    Comedy    Action    Biography Comedy    Action    Action    Comedy    Animation Action    Animation Action   
##  [86] Horror    Action    Action    Horror    Comedy    Drama     Animation Animation Action    Drama     Action    Biography Comedy    Comedy    Action   
## Levels: Action Adventure Animation Biography Comedy Crime Drama Horror</code></pre>
<p><strong>D) IMDB rating:</strong></p>
<p>We use CSS selectors to scrap the IMDB rating section. Then, we convert these ratings to numbers.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="web-scraping-in-r.html#cb397-1" aria-hidden="true" tabindex="-1"></a>rating_data_html <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(webpage,<span class="st">&#39;.ratings-imdb-rating strong&#39;</span>)</span>
<span id="cb397-2"><a href="web-scraping-in-r.html#cb397-2" aria-hidden="true" tabindex="-1"></a>rating_data <span class="ot">&lt;-</span> <span class="fu">html_text</span>(rating_data_html)</span>
<span id="cb397-3"><a href="web-scraping-in-r.html#cb397-3" aria-hidden="true" tabindex="-1"></a>rating_data<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(rating_data)</span>
<span id="cb397-4"><a href="web-scraping-in-r.html#cb397-4" aria-hidden="true" tabindex="-1"></a>rating_data</span></code></pre></div>
<pre><code>##   [1] 8.0 7.8 5.9 7.5 8.0 7.3 7.6 8.1 7.1 7.9 7.8 7.5 8.1 6.9 7.3 7.2 7.2 7.4 8.0 7.1 7.6 6.3 6.4 7.6 8.4 5.4 7.0 7.8 7.8 6.6 7.3 6.1 5.5 7.0 6.9 6.3 7.1 7.8 7.3 6.1 7.3 6.9
##  [43] 7.4 6.7 6.3 8.0 5.2 5.6 5.6 6.6 6.7 6.8 7.0 7.1 6.1 4.0 7.1 6.2 7.2 6.4 6.1 7.8 5.8 7.4 6.6 6.8 7.4 5.6 6.5 5.9 8.0 7.1 5.5 5.9 6.0 6.2 7.4 7.3 5.2 6.4 7.0 6.5 6.2 7.1
##  [85] 5.2 6.3 6.2 5.9 6.0 6.9 6.8 8.1 7.3 7.1 7.0 6.3 6.7 6.0 6.3 6.2</code></pre>
<p><strong>E) Film description:</strong></p>
<p>Finally, we use CSS selectors to retrieve the description of each film. Each description is a paragraph summarising the content of the film.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="web-scraping-in-r.html#cb399-1" aria-hidden="true" tabindex="-1"></a>description_data_html <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(webpage,<span class="st">&#39;.ratings-bar+ .text-muted&#39;</span>)</span>
<span id="cb399-2"><a href="web-scraping-in-r.html#cb399-2" aria-hidden="true" tabindex="-1"></a>description_data <span class="ot">&lt;-</span> <span class="fu">html_text</span>(description_data_html)</span>
<span id="cb399-3"><a href="web-scraping-in-r.html#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(description_data)</span></code></pre></div>
<pre><code>## [1] &quot;\nA wisecracking mercenary gets experimented on and becomes immortal but ugly, and sets out to track down the man who ruined his looks.&quot;                                              
## [2] &quot;\nIn a time of conflict, a group of unlikely heroes band together on a mission to steal the plans to the Death Star, the Empire&#39;s ultimate weapon of destruction.&quot;                    
## [3] &quot;\nA secret government agency recruits some of the most dangerous incarcerated super-villains to form a defensive task force. Their first mission: save the world from the apocalypse.&quot;
## [4] &quot;\nWhile on a journey of physical and spiritual healing, a brilliant neurosurgeon is drawn into the world of the mystic arts.&quot;                                                         
## [5] &quot;\nWhile navigating their careers in Los Angeles, a pianist and an actress fall in love while attempting to reconcile their aspirations for the future.&quot;                               
## [6] &quot;\nIn 1970s Los Angeles, a mismatched pair of private eyes investigate a missing girl and the mysterious death of a porn star.&quot;</code></pre>
<p>We remove the new line symbol and the extra spaces.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="web-scraping-in-r.html#cb401-1" aria-hidden="true" tabindex="-1"></a>description_data<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;&quot;</span>,description_data)</span>
<span id="cb401-2"><a href="web-scraping-in-r.html#cb401-2" aria-hidden="true" tabindex="-1"></a>description_data<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">&quot;  &quot;</span>,<span class="st">&quot;&quot;</span>,description_data)</span>
<span id="cb401-3"><a href="web-scraping-in-r.html#cb401-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(description_data)</span></code></pre></div>
<pre><code>## [1] &quot;A wisecracking mercenary gets experimented on and becomes immortal but ugly, and sets out to track down the man who ruined his looks.&quot;                                              
## [2] &quot;In a time of conflict, a group of unlikely heroes band together on a mission to steal the plans to the Death Star, the Empire&#39;s ultimate weapon of destruction.&quot;                    
## [3] &quot;A secret government agency recruits some of the most dangerous incarcerated super-villains to form a defensive task force. Their first mission: save the world from the apocalypse.&quot;
## [4] &quot;While on a journey of physical and spiritual healing, a brilliant neurosurgeon is drawn into the world of the mystic arts.&quot;                                                         
## [5] &quot;While navigating their careers in Los Angeles, a pianist and an actress fall in love while attempting to reconcile their aspirations for the future.&quot;                               
## [6] &quot;In 1970s Los Angeles, a mismatched pair of private eyes investigate a missing girl and the mysterious death of a porn star.&quot;</code></pre>
<p>Now that we have scraped all of those variables, we can put them together into one single table. Let’s use the data.frame() function to build a table where each of the variables we scraped before will become a column:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="web-scraping-in-r.html#cb403-1" aria-hidden="true" tabindex="-1"></a>films <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title=</span>title_data, <span class="at">Genre=</span>genre_data, <span class="at">Runtime=</span>runtime_data, <span class="at">Rank=</span>rank_data, <span class="at">IMDB_rating=</span>rating_data, <span class="at">Description=</span>description_data)</span></code></pre></div>
<p>Let’s have a look at the data set.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="web-scraping-in-r.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(films)</span></code></pre></div>
<pre><code>##            Title  Genre Runtime Rank IMDB_rating
## 1       Deadpool Action     108    1         8.0
## 2      Rogue One Action     133    2         7.8
## 3  Suicide Squad Action     123    3         5.9
## 4 Doctor Strange Action     115    4         7.5
## 5     La La Land Comedy     128    5         8.0
## 6  The Nice Guys Action     116    6         7.3
##                                                                                                                                                                           Description
## 1                                               A wisecracking mercenary gets experimented on and becomes immortal but ugly, and sets out to track down the man who ruined his looks.
## 2                     In a time of conflict, a group of unlikely heroes band together on a mission to steal the plans to the Death Star, the Empire&#39;s ultimate weapon of destruction.
## 3 A secret government agency recruits some of the most dangerous incarcerated super-villains to form a defensive task force. Their first mission: save the world from the apocalypse.
## 4                                                          While on a journey of physical and spiritual healing, a brilliant neurosurgeon is drawn into the world of the mystic arts.
## 5                                While navigating their careers in Los Angeles, a pianist and an actress fall in love while attempting to reconcile their aspirations for the future.
## 6                                                         In 1970s Los Angeles, a mismatched pair of private eyes investigate a missing girl and the mysterious death of a porn star.</code></pre>
<p>It looks structured and contains all the data we wanted. Now we can start analysing it.</p>
</div>
<div id="performing-exploratory-data-analysis-eda-on-scraped-data" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Performing exploratory data analysis (EDA) on scraped data<a href="web-scraping-in-r.html#performing-exploratory-data-analysis-eda-on-scraped-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s explore the IMDB data we scraped. To do so, we will apply some of the principles and techniques for univariate and bivariate data expolation we learnt about in the previous sessions.</p>
<p>The first thing we always have to do when analysing data is looking at it. so let’s create a histogram of film duration and add a line representing the average (mean).</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="web-scraping-in-r.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(films<span class="sc">$</span>Runtime, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">main=</span><span class="st">&quot;IMDB film duration&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Runtime (minutes)&quot;</span>)</span>
<span id="cb406-2"><a href="web-scraping-in-r.html#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(films<span class="sc">$</span>Runtime), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p>
<p>We see that film duration is unimodal (with one single bump). Most films last about one and a half hours, while very few last more than 2 and a half hours.</p>
<p>Now let’s look at the rating IMDB has assigned to each film. We can visualise this as a stripchart.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="web-scraping-in-r.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(films<span class="sc">$</span>IMDB_rating, <span class="at">method =</span> <span class="st">&quot;stack&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">main=</span><span class="st">&quot;IMDB film rating&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Rating&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-255-1.png" width="672" /></p>
<p>We almost never see a rating below 5. This makes sense because, in the end, we are only looking at the top 100 films of the year, so perhaps all the lowly rated films did not make it to this list. There are also very few films with a rating higher than 8.</p>
<p>Now let’s use ggplot to create a scatter plot of rating and duration. Is there any relation between the duration of a film and how good or badly it is rated?</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="web-scraping-in-r.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>films, <span class="fu">aes</span>(<span class="at">x=</span>Runtime, <span class="at">y=</span>IMDB_rating)) <span class="sc">+</span> </span>
<span id="cb408-2"><a href="web-scraping-in-r.html#cb408-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb408-3"><a href="web-scraping-in-r.html#cb408-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Runtime (minutes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb408-4"><a href="web-scraping-in-r.html#cb408-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb408-5"><a href="web-scraping-in-r.html#cb408-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-256-1.png" width="672" /></p>
<p>Just by eye, we can see little relation between both variables. This also makes sense: knowing how long a film is does not necesarilly tell us anything about how good or bad it is.</p>
<p>Let’s corroborate this by alculating the correlation between both variables.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="web-scraping-in-r.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(films<span class="sc">$</span>Runtime, films<span class="sc">$</span>IMDB_rating)</span></code></pre></div>
<pre><code>## [1] 0.2957725</code></pre>
<p>The correlation is indeed very low, but it is still possitive! This means that perhaps, even though we cannot really see this correlation by eye, longer films tend to get ranked slightly better.</p>
<p>Let’s find which are the top 10 films of 2016 by IMDB rating:</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="web-scraping-in-r.html#cb411-1" aria-hidden="true" tabindex="-1"></a>top10films <span class="ot">&lt;-</span> films[<span class="fu">order</span>(<span class="sc">-</span>films<span class="sc">$</span>IMDB_rating),][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb411-2"><a href="web-scraping-in-r.html#cb411-2" aria-hidden="true" tabindex="-1"></a>top10films</span></code></pre></div>
<pre><code>##                  Title     Genre Runtime Rank IMDB_rating
## 25          Your Name. Animation     106   25         8.4
## 8        Hacksaw Ridge Biography     139    8         8.1
## 13      The Handmaiden     Drama     145   13         8.1
## 92      A Silent Voice Animation     130   92         8.1
## 1             Deadpool    Action     108    1         8.0
## 5           La La Land    Comedy     128    5         8.0
## 19         Zootropolis Animation     108   19         8.0
## 46                Lion Biography     118   46         8.0
## 71 The Invisible Guest     Crime     106   71         8.0
## 10             Arrival     Drama     116   10         7.9
##                                                                                                                                                                                                             Description
## 25                                                                                  Two strangers find themselves linked in a bizarre way. When a connection forms, will distance be the only thing to keep them apart?
## 8  World War II American Army Medic Desmond T. Doss, who served during the Battle of Okinawa, refuses to kill people and becomes the first man in American history to receive the Medal of Honor without firing a shot.
## 13                                                                                                       A woman is hired as a handmaiden to a Japanese heiress, but secretly she is involved in a plot to defraud her.
## 92                                                       A young man is ostracized by his classmates after he bullies a deaf girl to the point where she moves away. Years later, he sets off on a path for redemption.
## 1                                                                                 A wisecracking mercenary gets experimented on and becomes immortal but ugly, and sets out to track down the man who ruined his looks.
## 5                                                                  While navigating their careers in Los Angeles, a pianist and an actress fall in love while attempting to reconcile their aspirations for the future.
## 19                                                                                    In a city of anthropomorphic animals, a rookie bunny cop and a cynical con artist fox must work together to uncover a conspiracy.
## 46                                              A five-year-old Indian boy is adopted by an Australian couple after getting lost hundreds of kilometers from home. 25 years later, he sets out to find his lost family.
## 71                                                                      A successful entrepreneur accused of murder and a witness preparation expert have less than three hours to come up with an impregnable defense.
## 10                                                                                   A linguist works with the military to communicate with alien lifeforms after twelve mysterious spacecraft appear around the world.</code></pre>
<p>Now let’s add their name labels to the previous plot using geom_text_repel().</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="web-scraping-in-r.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>films, <span class="fu">aes</span>(<span class="at">x=</span>Runtime, <span class="at">y=</span>IMDB_rating)) <span class="sc">+</span> </span>
<span id="cb413-2"><a href="web-scraping-in-r.html#cb413-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb413-3"><a href="web-scraping-in-r.html#cb413-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>top10films, <span class="fu">aes</span>(<span class="at">label=</span>Title)) <span class="sc">+</span></span>
<span id="cb413-4"><a href="web-scraping-in-r.html#cb413-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Runtime (minutes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb413-5"><a href="web-scraping-in-r.html#cb413-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb413-6"><a href="web-scraping-in-r.html#cb413-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-259-1.png" width="672" /></p>
<p>We can even colour code the films by genre.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="web-scraping-in-r.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>films, <span class="fu">aes</span>(<span class="at">x=</span>Runtime, <span class="at">y=</span>IMDB_rating)) <span class="sc">+</span> </span>
<span id="cb414-2"><a href="web-scraping-in-r.html#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Genre),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb414-3"><a href="web-scraping-in-r.html#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>top10films, <span class="fu">aes</span>(<span class="at">label=</span>Title)) <span class="sc">+</span></span>
<span id="cb414-4"><a href="web-scraping-in-r.html#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Runtime (minutes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-5"><a href="web-scraping-in-r.html#cb414-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-6"><a href="web-scraping-in-r.html#cb414-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<pre><code>## Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider increasing max.overlaps</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
<p>However, it is very difficult to distinguis the different colours. In general, it’s not a good idea to display three variables at the same time if we do not have to.</p>
<p>For now, let’s focus only on the IMDB ranking and the genre. We can create box plots to compare the ranking of each group:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="web-scraping-in-r.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>films, <span class="fu">aes</span>(<span class="at">x=</span>Genre, <span class="at">y=</span>IMDB_rating)) <span class="sc">+</span> </span>
<span id="cb416-2"><a href="web-scraping-in-r.html#cb416-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb416-3"><a href="web-scraping-in-r.html#cb416-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Genre&quot;</span>) <span class="sc">+</span></span>
<span id="cb416-4"><a href="web-scraping-in-r.html#cb416-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb416-5"><a href="web-scraping-in-r.html#cb416-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-261-1.png" width="672" /></p>
<p>However note that now we are losing a lot of valuable information on what the individual ratings are. This is because box plots then to “over summarise” the data. Let’s use instead a better alternative called “violin plot”, which is a way to compare density plots for multiple groups.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="web-scraping-in-r.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>films, <span class="fu">aes</span>(<span class="at">x=</span>Genre, <span class="at">y=</span>IMDB_rating)) <span class="sc">+</span> </span>
<span id="cb417-2"><a href="web-scraping-in-r.html#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb417-3"><a href="web-scraping-in-r.html#cb417-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Genre&quot;</span>) <span class="sc">+</span></span>
<span id="cb417-4"><a href="web-scraping-in-r.html#cb417-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb417-5"><a href="web-scraping-in-r.html#cb417-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
<p>We can even add the individual points to ech of this plots too:</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="web-scraping-in-r.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>films, <span class="fu">aes</span>(<span class="at">x=</span>Genre, <span class="at">y=</span>IMDB_rating)) <span class="sc">+</span> </span>
<span id="cb418-2"><a href="web-scraping-in-r.html#cb418-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb418-3"><a href="web-scraping-in-r.html#cb418-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb418-4"><a href="web-scraping-in-r.html#cb418-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Genre&quot;</span>) <span class="sc">+</span></span>
<span id="cb418-5"><a href="web-scraping-in-r.html#cb418-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb418-6"><a href="web-scraping-in-r.html#cb418-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-263-1.png" width="672" /></p>
<p>Now we see that there is one Crime film with very poor rating compared to the rest. Other than that, all genres seem to be more or less equally popular.</p>
<p>Let’s repeat the same procedure, but now analysing the duration of each film stratified by genre.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="web-scraping-in-r.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>films, <span class="fu">aes</span>(<span class="at">x=</span>Genre, <span class="at">y=</span>Runtime)) <span class="sc">+</span> </span>
<span id="cb419-2"><a href="web-scraping-in-r.html#cb419-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb419-3"><a href="web-scraping-in-r.html#cb419-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb419-4"><a href="web-scraping-in-r.html#cb419-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Genre&quot;</span>) <span class="sc">+</span></span>
<span id="cb419-5"><a href="web-scraping-in-r.html#cb419-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb419-6"><a href="web-scraping-in-r.html#cb419-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-264-1.png" width="672" /></p>
<p>Now we find something interesting: most of the animation films are much shorter than films of any other genre. In fact, none of them lasts ore than an hour and a half. Some action films, on the other hand, go up to 2.5 hours. This makes sense too, since most animation films are designed for kids, who cannot possibly pay attention to a 2 or 3-hour long film.</p>
<p>Finally, let’s use the function “wordcloud()” to find out which are the most commonly used words to describe these 100 films. For a word to be included in the cloud it has to appear at least 3 times in the description. The size of each word is proportional to the number of times it appears.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="web-scraping-in-r.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(films<span class="sc">$</span>Description, <span class="at">scale=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="fl">0.3</span>))</span></code></pre></div>
<pre><code>## Warning in tm_map.SimpleCorpus(corpus, tm::removePunctuation): transformation drops documents</code></pre>
<pre><code>## Warning in tm_map.SimpleCorpus(corpus, function(x) tm::removeWords(x, tm::stopwords())): transformation drops documents</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-265-1.png" width="672" /></p>
<p>We see that a lot of films are described using words such as “world”, “must” and “new”.</p>
<p>Now you know how to perform web scraping with R and how to retrieve specific data from a website for further analysis.</p>
</div>
<div id="exercises-5" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Exercises<a href="web-scraping-in-r.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you want to obtain more web scraping experience, you can do the following:</p>
<ol style="list-style-type: decimal">
<li>Visit your favourite website</li>
<li>Use the Selector Gadget to retrieve the CSS selector for different sections of the site</li>
<li>Use R and the CSS selector to scrap the data that most interests you</li>
<li>Transform the variables to the appropriate format in R</li>
<li>Visualise them. What can you learn from this data?</li>
</ol>
</div>
<div id="references-2" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> References<a href="web-scraping-in-r.html#references-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Kaushik S. (March 27, 2017). Beginner’s guide on web scraping in R using rvest. Available from: <a href="https://www.analyticsvidhya.com/blog/2017/03/beginners-guide-on-web-scraping-in-r-using-rvest-with-hands-on-knowledge/" class="uri">https://www.analyticsvidhya.com/blog/2017/03/beginners-guide-on-web-scraping-in-r-using-rvest-with-hands-on-knowledge/</a></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multivariate-data-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="machine-learning-fundamentals-spam-detection-using-a-naive-bayes-classifier.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-Web-scraping.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
